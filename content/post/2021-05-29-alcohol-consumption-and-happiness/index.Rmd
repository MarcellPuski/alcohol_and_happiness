---
title: Alcohol consumption and happiness
author: Marcell Puski
date: '2021-05-29'
slug: alcohol-consumption-and-happiness
categories: []
tags:
  - R Markdown
  - plot
---


In this short analysis i was curious about the connection of countries state of global happiness and their alcohol consumptions. In countries where people are generally satisfied and happy overall less alcohol is consumed? Or is it the opposit, that in countries where people tend to drink more, are people also happier?  

To answer this question i am investigating two datasets available online in [kagle](https://www.kaggle.com/).

One of the datasets is the [World Happiness Report](https://www.kaggle.com/unsdsn/world-happiness?select=2015.csv) which is a landmark survey of the state of global happiness. It contains 158 countries estimated happiness score (10 - happiest 0 -least happy) and the ranking based on that score. It also containes six factors: economic production, social support, life expectancy, freedom, absence of corruption, and generosity, which represents the contribution of this factors of making life evaluations higher in each country than they are in Dystopia, a hypothetical country that has values equal to the worldâ€™s lowest national averages for each of the six factors.
I used the *World Happiness Report 2015*.   


The other dataset is the [Alcohol Comsumption around the World](https://www.kaggle.com/codebreaker619/alcohol-comsumption-around-the-world) which contains information of 193 countries alcohol consumptions, provided by the *World Health Organisation, Global Information System on Alcohol and Health (GISAH), 2010*. The dataset is providing information about on avarage how many glasses of wine, cans of beer and shots of spirits and the total liters of pure alcohol were drunk per person in each country in 2010. 

I combined this two datasets together so i got a dataset that contains information's about the countries happiness leveles and alcohol consumption as well. Unfortunatelly there is five years difference in the data collection for the happiness scores and alcohol consumption, but probably these characteristics of countries citisens changes slowly, and overall it only causes minor inaccuracies.  


```{r include=FALSE}
#  loading libraries

library(tidyverse)
library(readxl)
library(skimr)
library(dplyr)
library(knitr)

```


```{r include=FALSE}
# loading data

world_happiness <- read_csv("data/2015.csv")

alcohol <- read.csv("data/drinks.csv")

```


```{r include=FALSE}

# joining data

# renaming country column to be the same in the two datasets
world_happiness <- 
  world_happiness %>%
  rename(country = 'Country')

# joining the two datasets based on country names
dt <- left_join(world_happiness, alcohol)


# checking joined data
apply(is.na(dt),2,sum)

# creating data set for missing data
missing_dt <- 
  dt %>%
  filter(is.na(beer_servings))

```



```{r include=FALSE}

# in a few cases there is a mismatch between the datasets in the countries names causing more missing data
# The following names represent the same country:
    # United States = USA
    #Russia = Russian Federation
    #Congo (Brazzaville) = Congo
    #Congo (Kinshasa) = DR Congo
    #Trinidad and Tobago = Trinidad & Tobago
    #Somaliland region	= Somalia
    #Bosnia and Herzegovina = Bosnia-Herzegovina
    #Ivory Coast = Cote d'Ivoire

# correcting country names 

# creating coppy for safty
chumpa <- world_happiness 


# list of country names which needs to be replaced

csere <- c("United States", "Trinidad and Tobago", "Russia", "Somaliland region", "Bosnia and Herzegovina", "Congo (Brazzaville)","Congo (Kinshasa)","Ivory Coast")


# list of corrected country names

bere <- c("USA", "Trinidad & Tobago", "Russian Federation", "Somalia", "Bosnia-Herzegovina", "Congo", "DR Congo", "Cote d'Ivoire")


# renaming country names
szerint <- which(chumpa$country %in% csere)

for (i in 1:length(szerint)) {
  chumpa$country[szerint[i]] <-  bere[i]
  
  
}

# re joining data, with corrected names
dt_clear <- left_join(chumpa, alcohol)


# checking 
dim(dt_clear)
apply(is.na(dt_clear),2,sum)


```



```{r include=FALSE}
# Deleting rows where there is no data about alcohol consumtion 

dt_clear <- na.omit(dt_clear)

# checking
dim(dt_clear)

apply(is.na(dt_clear),2,sum)

```



```{r include=FALSE}
# renaming columns without spaces

dt_clear <- 
  dt_clear %>%
  rename(happiness_score = 'Happiness Score',
         happiness_rank = 'Happiness Rank',
         standard_error = 'Standard Error',
         GDP = 'Economy (GDP per Capita)',
         life_expectancy = 'Health (Life Expectancy)',
         corruption = 'Trust (Government Corruption)',
         dystopia_residual = 'Dystopia Residual',
         total_alcohol = 'total_litres_of_pure_alcohol')

```



```{r include=FALSE}
# creating sub-groups for alcohol consumption

dt_clear$alcohol_cat <- cut(dt_clear$total_alcohol, c(-1, 0, 5,10,15), labels = c("doesn't drink","drinks less than 5 liters", "drinks 5-10 liters", "drinks 10-15 liters"))

```

By joining the datasets together and keeping only the countries where is informations about alcohol drinking and happiness as well, there remained 153 countries. 


Table 1 shows the five happiest countries,  

```{r echo=FALSE, message=FALSE}
# table of 10 happiest countries

dt_clear %>%
  select(country:happiness_score, beer_servings:total_alcohol) %>%
  filter(happiness_rank <= 5) %>%
  kable(., digits = 2, align = "l", col.names = c("Country", "Region", "Happiness Rank", "Happiness Score", "Beer servings", "Spirit servings", "Wine servings", "Total liters of pure alcohol"), caption = "Ten five countries")


```



and Table 2 shows the top five most alcohol drinkinng countries.


```{r echo=FALSE, message=FALSE}

# table of 10 most alcohol drinking countries
dt_clear %>%
  select(country:happiness_score, beer_servings:total_alcohol) %>%
  arrange(desc(total_alcohol)) %>%
  top_n(5) %>%
  kable(., digits = 2, align = "l", col.names = c("Country", "Region", "Happiness Rank", "Happiness Score", "Beer servings", "Spirit servings", "Wine servings", "Total liters of pure alcohol"), caption = "Top five countries that drinks the most alcohol")


```



# Descriptive statistics by region's

```{r echo=FALSE}



# avarages about happiness and alcohol consumtion


# creating summary table by Regions - usufull but doesn't look good

# dt_clear %>%
#   group_by(Region) %>%
#   summarise(
#     mn_happiness = mean(happiness_score),
#     sd_happiness = sd(happiness_score),
#     max_happiness = max(happiness_score),
#     min_happiness = min(happiness_score),
#     mn_alcohol = mean(total_alcohol),
#     sd_alcohol = sd(total_alcohol),
#     max_alcohol = max(total_alcohol),
#     min_alcohol = min(total_alcohol)
#   ) %>%
#   kable(., digits = 2, align = "l", col.names = c("Region", "mean happiness", "happiness standard deviation", "max happiness score", "minimum happiness score", "mean total liters of alcohol", "standard deviation of total liters of alcohol", "maximum total liters of alcohol", "minimum total liters of alcohol"), caption = "Summary table by Regions")

# Ploting summary table

plot_1 <- dt_clear %>%
  group_by(Region) %>%
  summarise(
    mn_happiness = mean(happiness_score),
    sd_happiness = sd(happiness_score),
    max_happiness = max(happiness_score),
    min_happiness = min(happiness_score),
    mn_alcohol = mean(total_alcohol),
    sd_alcohol = sd(total_alcohol),
    max_alcohol = max(total_alcohol),
    min_alcohol = min(total_alcohol)
  )



plot_1 %>%
  ggplot() +
  geom_bar(aes(x = Region, y = mn_happiness), stat = "identity", fill = "skyblue1") +
  geom_errorbar(aes(x = Region, ymin = mn_happiness - sd_happiness, ymax = mn_happiness + sd_happiness), color = "red3") +
  labs(title = "Happiness levels by regions",
       x = "", y = "mean happiness score") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90))

plot_1 %>%
  ggplot() +
  geom_bar(aes(x = Region, y = mn_alcohol), stat = "identity", fill = "skyblue1") +
  geom_errorbar(aes(x = Region, ymin = mn_alcohol - sd_alcohol, ymax = mn_alcohol + sd_alcohol), color = "red3") +
  labs(title = "Alcohol consumption by regions",
       x = "", y = "mean total liters of alcohol") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90))
  

# alcohol / happiness rank + Region

dt_clear %>%
  arrange(happiness_rank) %>%
  ggplot() +
  geom_point(mapping = aes(x = happiness_rank, y = total_alcohol, color = Region)) +
  labs(title = "Happiness rank and alcohol consumption by region's",
       x = "Happiness rank",
       y = "mean total liters of alcohol") +
  theme_classic()



# # alcohol /happinass rank + Region - Doesn't look good 
# dt_clear %>%
#   arrange(happiness_rank) %>%
#   ggplot() +
#   geom_point(mapping = aes(x = happiness_rank, y = total_alcohol, color = Region)) +
#   facet_wrap(~Region) +
#   labs(title = "Happiness rank and alcohol consumption by region's",
#        x = "Happiness rank",
#        y = "mean total liters of alcohol") +
#   theme_classic()
# 


```






# Does happy countries drink less alcohol?





```{r echo=FALSE, message=FALSE}

# ugyanez + smoothal 

dt_clear %>%
  arrange(happiness_rank) %>%
  ggplot(., mapping = aes(x = happiness_rank, y = total_alcohol)) +
  geom_point(shape = 21, color = "black", fill = "steelblue", alpha = 1/2, size = 2) +
  geom_smooth(color = "firebrick")




```


ugyanaz a kerdes meg


```{r echo=FALSE}
dt_clear %>%
  arrange(happiness_rank) %>%
  ggplot() +
  geom_point(mapping = aes(x = happiness_rank, y = total_alcohol, color = alcohol_cat))

# it seems like it is exacly the opposit

dt_clear %>%
  group_by(alcohol_cat) %>%
  summarise(
    mean_happiness = mean(happiness_score),
    sd_happiness = sd(happiness_score),
    mean_happy_rank = mean(happiness_rank),
    sd_happy_rank = sd(happiness_rank)
  ) %>%
  kable(., digits = 2, align = "l", caption = "Avarages about talalj ki valamit")


dt_clear %>%
  group_by(alcohol_cat) %>%
  summarise(
    mean_happiness = mean(happiness_score),
    sd_happiness = sd(happiness_score),
    mean_happy_rank = mean(happiness_rank),
    sd_happy_rank = sd(happiness_rank)
  ) %>%
  ggplot() +
  geom_bar(aes(x = alcohol_cat, y = mean_happiness), stat = "identity") +
  geom_hline(yintercept = mean(dt_clear$happiness_score), linetype="dotted", color = "red")



```





# Countries where people do not drink alcohol



```{r echo=FALSE}
# summary table 
dt_clear %>%
  filter(total_alcohol == 0) %>%
  select(happiness_rank, country, happiness_score, total_alcohol)



# plot
dt_clear %>%
  filter(total_alcohol == 0) %>%
  arrange(happiness_rank) %>%
  ggplot() +
  geom_bar(mapping = aes(x = Region, y = happiness_score, fill = country), stat = "identity", position = "dodge") +
  geom_hline(yintercept = mean(dt_clear$happiness_score), linetype="dotted", color = "red")
  


```



# question two - Do people in happy countries drink different kind of alcohol?


```{r echo=FALSE}
# for safety
plot_servings <- dt_clear

# creating happiness categories

plot_servings$happy_cat <- cut(plot_servings$happiness_rank, c(-1, 50, 100, 160), labels = c("happy", "medium happy", "not happy"))



# table

plot_servings %>%
  group_by(happy_cat) %>%
  summarise(
    mn_beer = mean(beer_servings),
    mn_spirit = mean(spirit_servings),
    mn_wine = mean(wine_servings),
    mn_total = mean(total_alcohol)
  ) %>%
  kable(., digits = 2, align = "l", caption = "Valami")


# make the data long format to be able to plot it

plot_servings_plot <- plot_servings %>%
  group_by(happy_cat) %>%
  summarise(
    mn_beer = mean(beer_servings),
    mn_spirit = mean(spirit_servings),
    mn_wine = mean(wine_servings),
    mn_total = mean(total_alcohol)
  ) %>%
  gather(data = ., 
       key = alcohol_type, value = servings,
       'mn_beer':'mn_wine')


# plot

plot_servings_plot %>%
  ggplot() +
  geom_bar(mapping = aes(x = happy_cat, y = servings, fill = alcohol_type), stat = "identity", position = "dodge")

```




# question three - lets see sub categories of happiness: GDP etc.



```{r echo=FALSE, message=FALSE}
# GDP

dt_clear %>%
  ggplot(., mapping = aes(x = GDP, y = total_alcohol)) +
  geom_point(shape = 21, color = "black", fill = "steelblue", alpha = 1/2, size = 2) +
  geom_smooth(color = "firebrick") +
  ylim(0, 15)

# Family
dt_clear %>%
  ggplot(., mapping = aes(x = Family, y = total_alcohol)) +
  geom_point(shape = 21, color = "black", fill = "steelblue", alpha = 1/2, size = 2) +
  geom_smooth(color = "firebrick") +
  ylim(0, 15)

# life_expectansy

dt_clear %>%
  ggplot(., mapping = aes(x = life_expectancy, y = total_alcohol)) +
  geom_point(shape = 21, color = "black", fill = "steelblue", alpha = 1/2, size = 2) +
  geom_smooth(color = "firebrick") +
  ylim(0, 15)

# Freedom

dt_clear %>%
  ggplot(., mapping = aes(x = Freedom, y = total_alcohol)) +
  geom_point(shape = 21, color = "black", fill = "steelblue", alpha = 1/2, size = 2) +
  geom_smooth(color = "firebrick") +
  ylim(0, 15)

# corruption

dt_clear %>%
  ggplot(., mapping = aes(x = corruption, y = total_alcohol)) +
  geom_point(shape = 21, color = "black", fill = "steelblue", alpha = 1/2, size = 2) +
  geom_smooth(color = "firebrick") +
  ylim(0, 15)

# generosity

dt_clear %>%
  ggplot(., mapping = aes(x = Generosity, y = total_alcohol)) +
  geom_point(shape = 21, color = "black", fill = "steelblue", alpha = 1/2, size = 2) +
  geom_smooth(color = "firebrick") +
  ylim(0, 15)


```


