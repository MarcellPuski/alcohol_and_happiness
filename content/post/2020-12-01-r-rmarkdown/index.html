---
title: "Countries alcohol consumtion and happiness levels"
author: "Marcell Puski"
date: 2020-05-29T21:13:14-05:00
categories: ["R"]
tags: ["R Markdown", "plot"]
---



<div id="libraries" class="section level1">
<h1>libraries</h1>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## -- Attaching packages ---------------------------------- tidyverse 1.2.1 --</code></pre>
<pre><code>## v ggplot2 3.2.1     v purrr   0.3.3
## v tibble  2.1.3     v dplyr   0.8.3
## v tidyr   1.0.0     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.4.0</code></pre>
<pre><code>## -- Conflicts ------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(readxl)
library(skimr)</code></pre>
<pre><code>## Warning: package &#39;skimr&#39; was built under R version 3.6.3</code></pre>
<pre class="r"><code>library(dplyr)
library(knitr)</code></pre>
</div>
<div id="loading-data" class="section level1">
<h1>loading data</h1>
<pre class="r"><code>world_happiness &lt;- read_csv(&quot;data/2015.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Country = col_character(),
##   Region = col_character(),
##   `Happiness Rank` = col_double(),
##   `Happiness Score` = col_double(),
##   `Standard Error` = col_double(),
##   `Economy (GDP per Capita)` = col_double(),
##   Family = col_double(),
##   `Health (Life Expectancy)` = col_double(),
##   Freedom = col_double(),
##   `Trust (Government Corruption)` = col_double(),
##   Generosity = col_double(),
##   `Dystopia Residual` = col_double()
## )</code></pre>
<pre class="r"><code>alcohol &lt;- read.csv(&quot;data/drinks.csv&quot;)</code></pre>
</div>
<div id="joining-data" class="section level1">
<h1>joining data</h1>
<pre class="r"><code># renaming country column to be the same in the two datasets
world_happiness &lt;- 
  world_happiness %&gt;%
  rename(country = &#39;Country&#39;)

# joining the two datasets based on country names
dt &lt;- left_join(world_happiness, alcohol)</code></pre>
<pre><code>## Joining, by = &quot;country&quot;</code></pre>
<pre><code>## Warning: Column `country` joining character vector and factor, coercing
## into character vector</code></pre>
<pre class="r"><code># checking joined data
apply(is.na(dt),2,sum)</code></pre>
<pre><code>##                       country                        Region 
##                             0                             0 
##                Happiness Rank               Happiness Score 
##                             0                             0 
##                Standard Error      Economy (GDP per Capita) 
##                             0                             0 
##                        Family      Health (Life Expectancy) 
##                             0                             0 
##                       Freedom Trust (Government Corruption) 
##                             0                             0 
##                    Generosity             Dystopia Residual 
##                             0                             0 
##                 beer_servings               spirit_servings 
##                            13                            13 
##                 wine_servings  total_litres_of_pure_alcohol 
##                            13                            13</code></pre>
<pre class="r"><code># creating data set for missing data
missing_dt &lt;- 
  dt %&gt;%
  filter(is.na(beer_servings))</code></pre>
<p>in a few cases there is a mismatch between the datasets in the countries names causing more missing data</p>
<p>The following names represent the same country:</p>
<p>United States = USA
Russia = Russian Federation
Congo (Brazzaville) = Congo
Congo (Kinshasa) = DR Congo
Trinidad and Tobago = Trinidad &amp; Tobago
Somaliland region = Somalia
Bosnia and Herzegovina = Bosnia-Herzegovina
Ivory Coast = Cote dâ€™Ivoire</p>
</div>
<div id="correcting-country-names" class="section level1">
<h1>correcting country names</h1>
<pre class="r"><code># creating coppy for safty
chumpa &lt;- world_happiness 


# list of country names which needs to be replaced

csere &lt;- c(&quot;United States&quot;, &quot;Trinidad and Tobago&quot;, &quot;Russia&quot;, &quot;Somaliland region&quot;, &quot;Bosnia and Herzegovina&quot;, &quot;Congo (Brazzaville)&quot;,&quot;Congo (Kinshasa)&quot;,&quot;Ivory Coast&quot;)


# list of corrected country names

bere &lt;- c(&quot;USA&quot;, &quot;Trinidad &amp; Tobago&quot;, &quot;Russian Federation&quot;, &quot;Somalia&quot;, &quot;Bosnia-Herzegovina&quot;, &quot;Congo&quot;, &quot;DR Congo&quot;, &quot;Cote d&#39;Ivoire&quot;)


# renaming country names
szerint &lt;- which(chumpa$country %in% csere)

for (i in 1:length(szerint)) {
  chumpa$country[szerint[i]] &lt;-  bere[i]
  
  
}

# re joining data, with corrected names
dt_clear &lt;- left_join(chumpa, alcohol)</code></pre>
<pre><code>## Joining, by = &quot;country&quot;</code></pre>
<pre><code>## Warning: Column `country` joining character vector and factor, coercing
## into character vector</code></pre>
<pre class="r"><code># checking 
dim(dt_clear)</code></pre>
<pre><code>## [1] 158  16</code></pre>
<pre class="r"><code>apply(is.na(dt_clear),2,sum)</code></pre>
<pre><code>##                       country                        Region 
##                             0                             0 
##                Happiness Rank               Happiness Score 
##                             0                             0 
##                Standard Error      Economy (GDP per Capita) 
##                             0                             0 
##                        Family      Health (Life Expectancy) 
##                             0                             0 
##                       Freedom Trust (Government Corruption) 
##                             0                             0 
##                    Generosity             Dystopia Residual 
##                             0                             0 
##                 beer_servings               spirit_servings 
##                             5                             5 
##                 wine_servings  total_litres_of_pure_alcohol 
##                             5                             5</code></pre>
</div>
<div id="deleting-na-rows" class="section level1">
<h1>Deleting NA rows</h1>
<p>Deleting rows where there is no data about alcohol consumtion</p>
<pre class="r"><code>dt_clear &lt;- na.omit(dt_clear)

# checking
dim(dt_clear)</code></pre>
<pre><code>## [1] 153  16</code></pre>
<pre class="r"><code>apply(is.na(dt_clear),2,sum)</code></pre>
<pre><code>##                       country                        Region 
##                             0                             0 
##                Happiness Rank               Happiness Score 
##                             0                             0 
##                Standard Error      Economy (GDP per Capita) 
##                             0                             0 
##                        Family      Health (Life Expectancy) 
##                             0                             0 
##                       Freedom Trust (Government Corruption) 
##                             0                             0 
##                    Generosity             Dystopia Residual 
##                             0                             0 
##                 beer_servings               spirit_servings 
##                             0                             0 
##                 wine_servings  total_litres_of_pure_alcohol 
##                             0                             0</code></pre>
</div>
<div id="renaming-columns-without-spaces" class="section level1">
<h1>renaming columns without spaces</h1>
<pre class="r"><code>dt_clear &lt;- 
  dt_clear %&gt;%
  rename(happiness_score = &#39;Happiness Score&#39;,
         happiness_rank = &#39;Happiness Rank&#39;,
         standard_error = &#39;Standard Error&#39;,
         GDP = &#39;Economy (GDP per Capita)&#39;,
         life_expectancy = &#39;Health (Life Expectancy)&#39;,
         corruption = &#39;Trust (Government Corruption)&#39;,
         dystopia_residual = &#39;Dystopia Residual&#39;,
         total_alcohol = &#39;total_litres_of_pure_alcohol&#39;)</code></pre>
</div>
<div id="creating-sub-groups" class="section level1">
<h1>creating sub-groups</h1>
<p>alcohol:</p>
<p>0-14.4</p>
<p>less than</p>
<pre class="r"><code>dt_clear$alcohol_cat &lt;- cut(dt_clear$total_alcohol, c(-1, 0, 5,10,15), labels = c(&quot;doesn&#39;t drink&quot;,&quot;drinks less than 5 liters&quot;, &quot;drinks 5-10 liters&quot;, &quot;drinks 10-15 liters&quot;))</code></pre>
</div>
<div id="basic-kable" class="section level1">
<h1>basic kable</h1>
<pre class="r"><code>kable(head(dt_clear), digits = 2, align = &quot;l&quot;, caption = &quot;Avarages about talalj ki valamit&quot;)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-8">Table 1: </span>Avarages about talalj ki valamit</caption>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="left">Region</th>
<th align="left">happiness_rank</th>
<th align="left">happiness_score</th>
<th align="left">standard_error</th>
<th align="left">GDP</th>
<th align="left">Family</th>
<th align="left">life_expectancy</th>
<th align="left">Freedom</th>
<th align="left">corruption</th>
<th align="left">Generosity</th>
<th align="left">dystopia_residual</th>
<th align="left">beer_servings</th>
<th align="left">spirit_servings</th>
<th align="left">wine_servings</th>
<th align="left">total_alcohol</th>
<th align="left">alcohol_cat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Switzerland</td>
<td align="left">Western Europe</td>
<td align="left">1</td>
<td align="left">7.59</td>
<td align="left">0.03</td>
<td align="left">1.40</td>
<td align="left">1.35</td>
<td align="left">0.94</td>
<td align="left">0.67</td>
<td align="left">0.42</td>
<td align="left">0.30</td>
<td align="left">2.52</td>
<td align="left">185</td>
<td align="left">100</td>
<td align="left">280</td>
<td align="left">10.2</td>
<td align="left">drinks 10-15 liters</td>
</tr>
<tr class="even">
<td align="left">Iceland</td>
<td align="left">Western Europe</td>
<td align="left">2</td>
<td align="left">7.56</td>
<td align="left">0.05</td>
<td align="left">1.30</td>
<td align="left">1.40</td>
<td align="left">0.95</td>
<td align="left">0.63</td>
<td align="left">0.14</td>
<td align="left">0.44</td>
<td align="left">2.70</td>
<td align="left">233</td>
<td align="left">61</td>
<td align="left">78</td>
<td align="left">6.6</td>
<td align="left">drinks 5-10 liters</td>
</tr>
<tr class="odd">
<td align="left">Denmark</td>
<td align="left">Western Europe</td>
<td align="left">3</td>
<td align="left">7.53</td>
<td align="left">0.03</td>
<td align="left">1.33</td>
<td align="left">1.36</td>
<td align="left">0.87</td>
<td align="left">0.65</td>
<td align="left">0.48</td>
<td align="left">0.34</td>
<td align="left">2.49</td>
<td align="left">224</td>
<td align="left">81</td>
<td align="left">278</td>
<td align="left">10.4</td>
<td align="left">drinks 10-15 liters</td>
</tr>
<tr class="even">
<td align="left">Norway</td>
<td align="left">Western Europe</td>
<td align="left">4</td>
<td align="left">7.52</td>
<td align="left">0.04</td>
<td align="left">1.46</td>
<td align="left">1.33</td>
<td align="left">0.89</td>
<td align="left">0.67</td>
<td align="left">0.37</td>
<td align="left">0.35</td>
<td align="left">2.47</td>
<td align="left">169</td>
<td align="left">71</td>
<td align="left">129</td>
<td align="left">6.7</td>
<td align="left">drinks 5-10 liters</td>
</tr>
<tr class="odd">
<td align="left">Canada</td>
<td align="left">North America</td>
<td align="left">5</td>
<td align="left">7.43</td>
<td align="left">0.04</td>
<td align="left">1.33</td>
<td align="left">1.32</td>
<td align="left">0.91</td>
<td align="left">0.63</td>
<td align="left">0.33</td>
<td align="left">0.46</td>
<td align="left">2.45</td>
<td align="left">240</td>
<td align="left">122</td>
<td align="left">100</td>
<td align="left">8.2</td>
<td align="left">drinks 5-10 liters</td>
</tr>
<tr class="even">
<td align="left">Finland</td>
<td align="left">Western Europe</td>
<td align="left">6</td>
<td align="left">7.41</td>
<td align="left">0.03</td>
<td align="left">1.29</td>
<td align="left">1.32</td>
<td align="left">0.89</td>
<td align="left">0.64</td>
<td align="left">0.41</td>
<td align="left">0.23</td>
<td align="left">2.62</td>
<td align="left">263</td>
<td align="left">133</td>
<td align="left">97</td>
<td align="left">10.0</td>
<td align="left">drinks 5-10 liters</td>
</tr>
</tbody>
</table>
</div>
<div id="does-happy-countries-drink-less-alcohol" class="section level1">
<h1>Does happy countries drink less alcohol?</h1>
<pre class="r"><code># alcohol / happiness rank + Region

dt_clear %&gt;%
  arrange(happiness_rank) %&gt;%
  ggplot() +
  geom_point(mapping = aes(x = happiness_rank, y = total_alcohol, color = Region))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code># ugyanez + smoothal 

dt_clear %&gt;%
  arrange(happiness_rank) %&gt;%
  ggplot(., mapping = aes(x = happiness_rank, y = total_alcohol)) +
  geom_point(shape = 21, color = &quot;black&quot;, fill = &quot;steelblue&quot;, alpha = 1/2, size = 2) +
  geom_smooth(color = &quot;firebrick&quot;)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<pre class="r"><code># alcohol /happinass rank + Region
dt_clear %&gt;%
  arrange(happiness_rank) %&gt;%
  ggplot() +
  geom_point(mapping = aes(x = happiness_rank, y = total_alcohol, color = Region)) +
  facet_wrap(~Region)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-9-3.png" width="672" /></p>
</div>
